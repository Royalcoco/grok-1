document.getElementById('generate').addEventListener('click', async () => {
  const content = document.getElementById('content').value;

  if (!content) {
    document.getElementById('status').innerText = 'Please enter some content.';
    return;
  }

  document.getElementById('status').innerText = 'Generating content...';

  const response = await fetch('https://api.openai.com/v1/engines/davinci-codex/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer YOUR_OPENAI_API_KEY`
    },
    body: JSON.stringify({
      prompt: content,
      max_tokens: 100
    })
  });

  const data = await response.json();
  const generatedContent = data.choices[0].text.trim();

  document.getElementById('content').value = generatedContent;
  document.getElementById('status').innerText = 'Content generated.';
});

document.getElementById('mint').addEventListener('click', async () => {
  const content = document.getElementById('content').value;

  if (!content) {
    document.getElementById('status').innerText = 'Please enter or generate some content.';
    return;
  }

  document.getElementById('status').innerText = 'Minting as NFT...';

  // Interact with Ethereum and smart contract to mint NFT
  try {
    const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
    const account = accounts[0];

    const web3 = new Web3(Web3.givenProvider || 'https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID');
    const contract = new web3.eth.Contract(contract_abi, contract_address);

    await contract.methods.mintBook(account, content).send({ from: account });

    document.getElementById('status').innerText = 'NFT minted successfully.';
  } catch (error) {
    console.error(error);
    document.getElementById('status').innerText = 'Error minting NFT.';
  }
});

const contract_abi = [
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "to",
        "type": "address"
      },
      {
        "internalType": "string",
        "name": "content",
        "type": "string"
      }
    ],
    "name": "mintBook",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  }
];

const contract_address = 'YOUR_CONTRACT_ADDRESS';
